{"version":3,"sources":["../src/hubot-qrank.js"],"names":["module","exports","robot","respond","res","crawler","parser","result","parse","get","getBody","message","forEach","value","index","stock","title","url","send","envelope","options","room","id","as_user","link_names","unfurl_links","adapter","client","web","chat","postMessage","text","_","defaults"],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AACA;;AACAA,OAAOC,OAAP,GAAiB,UAASC,KAAT,EAAgB;;AAE7BA,QAAMC,OAAN,CAAc,OAAd,EAAuB,UAASC,GAAT,EAAc;AACrC,QAAMC,UAAU,gCAAhB;AACA,QAAMC,SAAS,+BAAf;AACA,QAAIC,SAASD,OAAOE,KAAP,CAAaH,QAAQI,GAAR,CAAY,EAAZ,EAAgBC,OAAhB,CAAwB,MAAxB,CAAb,CAAb;AACA,QAAIC,UAAU,2BAAd;AACAJ,WAAOK,OAAP,CAAe,UAASC,KAAT,EAAgBC,KAAhB,EAAuB;AACpCH,oDAAmBE,MAAME,KAAzB,SAAkCF,MAAMG,KAAxC,SAAiDH,MAAMI,GAAvD;AACD,KAFD;AAGAC,SAAKhB,KAAL,EAAYE,IAAIe,QAAhB,EAA0BR,OAA1B;AACA;AACD,GAVC;AAWH,CAbD;;AAeA;AACA,IAAIO,OAAO,SAAPA,IAAO,CAAShB,KAAT,EAAgBiB,QAAhB,EAA0BR,OAA1B,EAAmC;AAC5C,MAAIS,OAAJ,EAAaC,IAAb;AACA,MAAIF,SAASE,IAAb,EAAmB;AACjBA,WAAOF,SAASE,IAAhB;AACD,GAFD,MAEO,IAAIF,SAASG,EAAb,EAAiB;AACtBD,WAAOF,SAASG,EAAhB;AACD;AACDF,YAAU;AACRG,aAAS,IADD;AAERC,gBAAY,CAFJ;AAGRC,kBAAc;AAHN,GAAV;AAKA,MAAI,OAAOd,OAAP,KAAmB,QAAvB,EAAiC;AAC/B,WAAOT,MAAMwB,OAAN,CAAcC,MAAd,CAAqBC,GAArB,CAAyBC,IAAzB,CAA8BC,WAA9B,CAA0CT,IAA1C,EAAgDV,QAAQoB,IAAxD,EAA8DC,EAAEC,QAAF,CAAWtB,OAAX,EAAoBS,OAApB,CAA9D,CAAP;AACD,GAFD,MAEO;AACL,WAAOlB,MAAMwB,OAAN,CAAcC,MAAd,CAAqBC,GAArB,CAAyBC,IAAzB,CAA8BC,WAA9B,CAA0CT,IAA1C,EAAgDV,OAAhD,EAAyDS,OAAzD,CAAP;AACD;AACF,CAjBD","file":"hubot-qrank.js","sourcesContent":["// Description:\n// Posting to Slack qiita articles from qrank.\n//\n// Commands:\n//   hubot qrank - <Posting to Slack qiita articles from qrank>\n//\n// Notes:\n//   <optional notes required for the script>\n//\n// Author:\n//   naname <naname@naname.net>\n\n'use strict';\nimport {QrankCrawler, QrankParser} from 'qrank-crawler';\nmodule.exports = function(robot) {\n\n    robot.respond(/qrank/, function(res) {\n    const crawler = new QrankCrawler();\n    const parser = new QrankParser();\n    let result = parser.parse(crawler.get(10).getBody('utf8'));\n    let message = 'Qiita articles ranking.\\n';\n    result.forEach(function(value, index) {\n      message += `ストック数${value.stock} ${value.title} ${value.url} \\n`;\n    });\n    send(robot, res.envelope, message);\n    //res.send(message);\n  });\n};\n\n//Copied from hubot-slack/src/client.coffee\nvar send = function(robot, envelope, message) {\n  var options, room;\n  if (envelope.room) {\n    room = envelope.room;\n  } else if (envelope.id) {\n    room = envelope.id;\n  }\n  options = {\n    as_user: true,\n    link_names: 1,\n    unfurl_links: false\n  };\n  if (typeof message !== 'string') {\n    return robot.adapter.client.web.chat.postMessage(room, message.text, _.defaults(message, options));\n  } else {\n    return robot.adapter.client.web.chat.postMessage(room, message, options);\n  }\n};\n\n"]}